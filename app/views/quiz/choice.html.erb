<div class="quiz-container">
  <h1>IT 詞彙測驗（選擇題）</h1>

  <div class="quiz-filters">
    <%= form_tag quiz_choice_path, method: :get, class: "filter-form" do %>
      <label for="category">分類：</label>
      <%= select_tag :category,
            options_for_select([["全部", ""]] + @categories.map { |c| [c, c] }, params[:category]),
            onchange: "this.form.submit()" %>

      <label for="difficulty">難度：</label>
      <%= select_tag :difficulty,
            options_for_select([["全部", ""], ["簡單", 1], ["中等", 2], ["困難", 3]], params[:difficulty]),
            onchange: "this.form.submit()" %>
    <% end %>
  </div>

  <% if @vocabulary %>
    <div class="quiz-card">
      <div class="quiz-category"><%= @vocabulary.category %></div>
      <div class="quiz-difficulty">
        難度：<%= "★" * @vocabulary.difficulty %><%= "☆" * (3 - @vocabulary.difficulty) %>
      </div>
      <div class="quiz-word-row">
        <div class="quiz-word"><%= @vocabulary.english %></div>
        <%= render "shared/favorite_button", vocabulary: @vocabulary, favorited: @favorited %>
      </div>
      <p class="quiz-prompt">請選擇正確的中文翻譯：</p>

      <div class="choice-options">
        <% @options.each do |option| %>
          <%= form_tag quiz_choice_answer_path, method: :post, class: "choice-form" do %>
            <%= hidden_field_tag :vocabulary_id, @vocabulary.id %>
            <%= hidden_field_tag :category, params[:category] %>
            <%= hidden_field_tag :difficulty, params[:difficulty] %>
            <%= hidden_field_tag :user_answer, option %>
            <%= submit_tag option, class: "btn btn-choice" %>
          <% end %>
        <% end %>
      </div>
    </div>
  <% else %>
    <div class="quiz-empty">
      <p>目前沒有符合條件的單字，請調整篩選條件。</p>
    </div>
  <% end %>

  <div class="quiz-nav">
    <%= link_to "錯誤單字複習", quiz_mistakes_path, class: "btn btn-secondary" %>
    <%= link_to "答題統計", dashboard_path, class: "btn btn-secondary" %>
  </div>
</div>
